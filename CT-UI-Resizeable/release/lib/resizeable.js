"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),selectorPrefix="ct-resizeable",edgeStep=5,minWidth=2,minHeight=2,Resizeable=function(){function i(e,t){(0,_classCallCheck2.default)(this,i),this.el=e,this.parent=t,this.disable=!1,this.initVar(),this.initEvents()}return(0,_createClass2.default)(i,[{key:"initVar",value:function(){this.isCanResize=!1,this.isDown=!1,this.baseX=null,this.baseY=null,this.baseWidth=this.el.offsetWidth,this.baseHeight=this.el.offsetHeight,this.leftCritical=-this.baseWidth+minWidth,this.rightCritical=this.baseWidth-minWidth,this.topCritical=-this.baseHeight+minHeight,this.bottomCritical=this.baseHeight-minHeight,this.direction=null,this.clientX=this.el.offsetLeft,this.clientY=this.el.offsetTop}},{key:"initEvents",value:function(){var c=this;this.el.addEventListener("mousedown",function(e){var t=c.disable;return(void 0===t||!t)&&(!!c.isCanResize&&(c.isDown=!0,(c.parent.cur=c).baseX=e.clientX,void(c.baseY=e.clientY)))}),this.el.addEventListener("mousemove",function(e){var t=c.disable;if(void 0!==t&&t)return!1;if(c.parent.cur&&c.parent.cur!==c)return!1;if(c.isCanResize&&c.isDown)return!1;e.preventDefault(),e.stopPropagation(),c.rect=c.el.getBoundingClientRect();var i=e.clientX,r=e.clientY;i-edgeStep<=c.rect.left&&r-edgeStep>c.rect.top&&r+edgeStep<c.rect.bottom?(c.direction="left",c.isCanResize=!0,c.el.style.cursor="w-resize"):i+edgeStep>=c.rect.right&&r-edgeStep>c.rect.top&&r+edgeStep<c.rect.bottom?(c.direction="right",c.isCanResize=!0,c.el.style.cursor="e-resize"):i-edgeStep<=c.rect.left&&r-edgeStep<=c.rect.top?(c.direction="lefttop",c.isCanResize=!0,c.el.style.cursor="nw-resize"):i-edgeStep<=c.rect.left&&r+edgeStep>=c.rect.bottom?(c.direction="leftbottom",c.isCanResize=!0,c.el.style.cursor="sw-resize"):i+edgeStep>=c.rect.right&&r-edgeStep<=c.rect.top?(c.direction="righttop",c.isCanResize=!0,c.el.style.cursor="ne-resize"):i+edgeStep>=c.rect.right&&r+edgeStep>=c.rect.bottom?(c.direction="rightbottom",c.isCanResize=!0,c.el.style.cursor="se-resize"):r-edgeStep<=c.rect.top&&i-edgeStep>c.rect.left&&i+edgeStep<c.rect.right?(c.direction="top",c.isCanResize=!0,c.el.style.cursor="n-resize"):r+edgeStep>=c.rect.bottom&&i-edgeStep>c.rect.left&&i+edgeStep<c.rect.right?(c.direction="bottom",c.isCanResize=!0,c.el.style.cursor="s-resize"):(c.isCanResize=!1,c.parent.cur=null,c.el.style.cursor="default")})}},{key:"reset",value:function(){this.isCanResize=!1,this.isDown=!1,this.baseX=null,this.baseY=null,this.baseWidth=this.el.offsetWidth,this.baseHeight=this.el.offsetHeight,this.leftCritical=-this.baseWidth+minWidth,this.rightCritical=this.baseWidth-minWidth,this.topCritical=-this.baseHeight+minHeight,this.bottomCritical=this.baseHeight-minHeight,this.clientX=this.el.offsetLeft,this.clientY=this.el.offsetTop,this.direction=null}},{key:"setDisable",value:function(e){this.disable=e}}]),i}(),ResizeableGroup=function(){function t(e){(0,_classCallCheck2.default)(this,t),this.el=e,this.disable=!1,this.rect=this.el.getBoundingClientRect(),this.cur=null,this.initEvents(),this.init()}return(0,_createClass2.default)(t,[{key:"initEvents",value:function(){var a=this;a.el.addEventListener("mousemove",function(e){var t=a.disable;if(void 0!==t&&t)return!1;if(!(a.cur&&a.cur.isCanResize&&a.cur.isDown))return a.cur&&a.reset(),!1;var i=e.clientX,r=e.clientY,c=i-a.cur.baseX,s=r-a.cur.baseY,n=a.cur.clientX,l=a.cur.clientY;"right"===a.cur.direction?a.cur.el.style.width=c>a.cur.leftCritical?"".concat(a.cur.baseWidth+c,"px"):"".concat(minWidth,"px"):"left"===a.cur.direction?(a.cur.el.style.width=c<a.cur.rightCritical?"".concat(a.cur.baseWidth-c,"px"):"".concat(minWidth,"px"),a.cur.el.style.left=c<a.cur.rightCritical?"".concat(n+c,"px"):"".concat(n+a.cur.rightCritical,"px")):"top"===a.cur.direction?(a.cur.el.style.height=s<a.cur.bottomCritical?"".concat(a.cur.baseHeight-s,"px"):"".concat(minHeight,"px"),a.cur.el.style.top=s<a.cur.bottomCritical?"".concat(l+s,"px"):"".concat(l+a.cur.bottomCritical,"px")):"bottom"===a.cur.direction?a.cur.el.style.height=s>a.cur.topCritical?"".concat(a.cur.baseHeight+s,"px"):"".concat(minHeight,"px"):"lefttop"===a.cur.direction?(a.cur.el.style.width=c<a.cur.rightCritical?"".concat(a.cur.baseWidth-c,"px"):"".concat(minWidth,"px"),a.cur.el.style.left=c<a.cur.rightCritical?"".concat(n+c,"px"):"".concat(n+a.cur.rightCritical,"px"),a.cur.el.style.height=s<a.cur.bottomCritical?"".concat(a.cur.baseHeight-s,"px"):"".concat(minHeight,"px"),a.cur.el.style.top=s<a.cur.bottomCritical?"".concat(l+s,"px"):"".concat(l+a.cur.bottomCritical,"px")):"leftbottom"===a.cur.direction?(a.cur.el.style.width=c<a.cur.rightCritical?"".concat(a.cur.baseWidth-c,"px"):"".concat(minWidth,"px"),a.cur.el.style.left=c<a.cur.rightCritical?"".concat(n+c,"px"):"".concat(n+a.cur.rightCritical,"px"),a.cur.el.style.height=s>a.cur.topCritical?"".concat(a.cur.baseHeight+s,"px"):"".concat(minHeight,"px")):"righttop"===a.cur.direction?(a.cur.el.style.width=c>a.cur.leftCritical?"".concat(a.cur.baseWidth+c,"px"):"".concat(minWidth,"px"),a.cur.el.style.height=s<a.cur.bottomCritical?"".concat(a.cur.baseHeight-s,"px"):"".concat(minHeight,"px"),a.cur.el.style.top=s<a.cur.bottomCritical?"".concat(l+s,"px"):"".concat(l+a.cur.bottomCritical,"px")):"rightbottom"===a.cur.direction&&(a.cur.el.style.width=c>a.cur.leftCritical?"".concat(a.cur.baseWidth+c,"px"):"".concat(minWidth,"px"),a.cur.el.style.height=s>a.cur.topCritical?"".concat(a.cur.baseHeight+s,"px"):"".concat(minHeight,"px"))}),a.el.addEventListener("mouseup",function(){var e=a.disable;return!(void 0!==e&&e)&&(!!(a.cur&&a.cur.isCanResize&&a.cur.isDown)&&void a.reset())})}},{key:"reset",value:function(){this.cur&&this.cur.reset(),this.cur=null}},{key:"init",value:function(){var e=this.el.querySelectorAll(".".concat(selectorPrefix,"-item"));this.ins=[];for(var t=0;t<e.length;t++)this.ins.push(new Resizeable(e[t],this,t))}},{key:"refresh",value:function(){this.init()}},{key:"setDisable",value:function(t){this.disable=t,this.ins.forEach(function(e){e.setDisable(t)})}}]),t}(),ResizeableGroupManager=function(){function e(){(0,_classCallCheck2.default)(this,e),this.init()}return(0,_createClass2.default)(e,[{key:"init",value:function(){this.resizeManagers=[];for(var e=document.querySelectorAll(".".concat(selectorPrefix)),t=0;t<e.length;t++)this.resizeManagers.push(new ResizeableGroup(e[t]))}},{key:"refresh",value:function(){this.init()}},{key:"setDisable",value:function(t){this.resizeManagers.forEach(function(e){e.setDisable(t)})}}]),e}(),ResizeableFactory={create:function(){return new ResizeableGroupManager}},_default=ResizeableFactory;exports.default=_default;
//# sourceMappingURL=resizeable.js.map
