{"version":3,"sources":["selectable.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","_classCallCheck2","selectorPrefix","initEvents","self","this","el","addEventListener","ev","isdown","console","log","cloneEl","ismove","parentElement","removeChild","baseX","clientX","baseY","clientY","tel","document","createElement","innerHTML","concat","firstElementChild","config","rangeClasses","length","map","className","classList","contains","add","style","left","top","upInclude","includeEls","appendChild","preventDefault","curX","curY","elRect","getBoundingClientRect","right","bottom","height","width","Math","abs","excludeEls","rangeRect","itemEls","querySelectorAll","i","itemEl","rect","xa1","xa2","ya1","ya2","xb1","xb2","yb1","yb2","push","moveInclude","moveExclude","body","Selectable","assign","call","SelectableFactory","create","_default"],"mappings":"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","file":"selectable.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\n/**\r\n * # CTSJ-UI-Selectable\r\n 支持PC的UI组件-Selectable\r\n\r\n 配置:\r\n el\r\n {\r\n   moveInclude: Function(Array<HtmlElement>) 选取到的元素\r\n   moveExclude: Function(Array<HtmlElement>) 未选取的元素\r\n   upInclude: Function(Array<HtmlElement>) 选取结束后选取的元素\r\n   rangeClasses: Array<String> 选取框的样式\r\n}\r\n\r\n 布局:\r\n <div>\r\n <div class=\"ct-selectable-item\"></div>\r\n ...\r\n </div>\r\n\r\n 功能:\r\n 在一个区域内进行选取，区域内带有ct-selectable-item样式的元素会参与计算\r\n 圈选中获取选中和非选中的元素，选取结束获取选取的元素\r\n\r\n 测试:\r\n\r\n log:\r\n .无限拖拽，可以脱出父窗口\r\n\r\n demo:\r\n .一个normal\r\n .二个互补影响的选区\r\n\r\n */\nvar selectorPrefix = 'ct-selectable-';\n/**\r\n * initEvents\r\n * @access private\r\n */\n\nfunction initEvents() {\n  var self = this;\n  /**\r\n   * mousedown\r\n   */\n\n  self.el.addEventListener('mousedown', function (ev) {\n    self.isdown = true;\n    console.log('mousedown');\n\n    if (self.cloneEl) {\n      self.ismove = false;\n      self.cloneEl.parentElement.removeChild(self.cloneEl);\n      self.cloneEl = null;\n    }\n\n    self.baseX = ev.clientX;\n    self.baseY = ev.clientY; // 创建区域dom\n\n    var tel = document.createElement('div');\n    tel.innerHTML = \"<div class=\\\"\".concat(selectorPrefix, \"select\\\"></div>\");\n    self.cloneEl = tel.firstElementChild;\n\n    if (self.config.rangeClasses && self.config.rangeClasses.length !== 0) {\n      self.config.rangeClasses.map(function (className) {\n        if (!self.cloneEl.classList.contains(className)) {\n          self.cloneEl.classList.add(className);\n        }\n      });\n    }\n\n    self.cloneEl.style.left = \"\".concat(self.baseX, \"px\");\n    self.cloneEl.style.top = \"\".concat(self.baseY, \"px\");\n    self.cloneEl.addEventListener('mouseup', function () {\n      self.ismove = false;\n      self.isdown = false;\n      self.baseX = null;\n      self.baseY = null;\n\n      if (self.cloneEl) {\n        self.cloneEl.parentElement.removeChild(self.cloneEl);\n        self.cloneEl = null;\n      }\n\n      if (self.config.upInclude) {\n        self.config.upInclude([].concat(self.includeEls));\n      }\n    });\n    self.cloneEl.addEventListener('mouseleave', function () {// console.log('鼠标离开了cloneEl');\n    });\n    self.el.appendChild(self.cloneEl);\n  });\n  /**\r\n   * mousemove\r\n   */\n\n  self.el.addEventListener('mousemove', function (ev) {\n    if (!self.isdown) return false;\n    self.ismove = true;\n    ev.preventDefault();\n    var curX = ev.clientX;\n    var curY = ev.clientY; // 不能拖动出el这个rect\n\n    var elRect = self.el.getBoundingClientRect();\n\n    if (!(curX >= elRect.left && curX <= elRect.right && curY >= elRect.top && curY <= elRect.bottom)) {\n      return false;\n    } // console.log(curX, curY);\n    // 水平\n\n\n    if (self.baseY === curY) {\n      self.cloneEl.style.height = '0';\n\n      if (self.baseX > curX) {\n        // console.log('水平左');\n        self.cloneEl.style.left = \"\".concat(curX, \"px\");\n        self.cloneEl.style.right = \"\".concat(self.baseX, \"px\");\n        self.cloneEl.style.top = \"\".concat(curY, \"px\");\n      } else if (self.baseX < curX) {\n        // 水平右\n        // console.log('水平右');\n        self.cloneEl.style.left = \"\".concat(self.baseX, \"px\");\n        self.cloneEl.style.right = \"\".concat(curX, \"px\");\n        self.cloneEl.style.top = \"\".concat(self.baseY, \"px\");\n      } else {\n        // 重合了\n        // console.log('重合了');\n        self.cloneEl.style.left = \"\".concat(self.baseX, \"px\");\n        self.cloneEl.style.right = \"\".concat(self.baseX, \"px\");\n        self.cloneEl.style.top = \"\".concat(self.baseY, \"px\");\n      }\n    } // 垂直\n    else if (self.baseX === curX) {\n        self.cloneEl.style.width = '0';\n\n        if (curY < self.baseY) {\n          // console.log('垂直上');\n          self.cloneEl.style.left = \"\".concat(self.baseX, \"px\");\n          self.cloneEl.style.top = \"\".concat(curY, \"px\");\n          self.cloneEl.style.bottom = \"\".concat(self.baseY, \"px\");\n        } else if (curY > self.baseY) {\n          // 垂直下\n          // console.log('垂直下');\n          self.cloneEl.style.left = \"\".concat(self.baseX, \"px\");\n          self.cloneEl.style.top = \"\".concat(self.baseY, \"px\");\n          self.cloneEl.style.bottom = \"\".concat(curY, \"px\");\n        } else {\n          // 重合了\n          // console.log('重合了');\n          self.cloneEl.style.left = \"\".concat(self.baseX, \"px\");\n          self.cloneEl.style.right = \"\".concat(self.baseX, \"px\");\n          self.cloneEl.style.top = \"\".concat(self.baseY, \"px\");\n        }\n      } // 带有角度\n      else {\n          var width = Math.abs(self.baseX - curX);\n          var height = Math.abs(self.baseY - curY);\n          var left;\n          var right;\n          var top;\n          var bottom;\n\n          if (curX < self.baseX && curY < self.baseY) {\n            // 左上\n            // console.log('左上');\n            // left\n            left = curX; // right\n\n            right = self.baseX; // top\n\n            top = curY; // bottom\n\n            bottom = self.baseY;\n          } else if (curX > self.baseX && curY < self.baseY) {\n            // 右上\n            // console.log('右上');\n            // left\n            left = self.baseX; // right\n\n            right = curX; // top\n\n            top = curY; // bottom\n\n            bottom = self.baseY;\n          } else if (curX < self.baseX && curY > self.baseY) {\n            // 左下\n            // console.log('左下');\n            // left\n            left = curX; // right\n\n            right = self.baseX; // top\n\n            top = self.baseY; // bottom\n\n            bottom = curY;\n          } else if (curX > self.baseX && curY > self.baseY) {\n            // 右下\n            // console.log('右下');\n            // left\n            left = self.baseX; // right\n\n            right = curX; // top\n\n            top = self.baseY; // bottom\n\n            bottom = curY;\n          }\n\n          self.cloneEl.style.width = \"\".concat(width, \"px\");\n          self.cloneEl.style.height = \"\".concat(height, \"px\");\n          self.cloneEl.style.left = \"\".concat(left, \"px\");\n          self.cloneEl.style.right = \"\".concat(right, \"px\");\n          self.cloneEl.style.top = \"\".concat(top, \"px\");\n          self.cloneEl.style.bottom = \"\".concat(bottom, \"px\");\n        }\n\n    self.includeEls = [];\n    self.excludeEls = [];\n    var rangeRect = self.cloneEl.getBoundingClientRect();\n    var itemEls = self.el.querySelectorAll(\".\".concat(selectorPrefix, \"item\"));\n\n    for (var i = 0; i < itemEls.length; i++) {\n      var itemEl = itemEls[i];\n      var rect = itemEl.getBoundingClientRect(); // console.log(rangeRect,rect)\n\n      var xa1 = rect.left;\n      var xa2 = rect.right;\n      var ya1 = rect.top;\n      var ya2 = rect.bottom;\n      var xb1 = rangeRect.left;\n      var xb2 = rangeRect.right;\n      var yb1 = rangeRect.top;\n      var yb2 = rangeRect.bottom;\n\n      if (Math.abs(xb2 + xb1 - xa2 - xa1) <= xa2 - xa1 + xb2 - xb1 && Math.abs(yb2 + yb1 - ya2 - ya1) <= ya2 - ya1 + yb2 - yb1 // (rect.left >= rangeRect.left && rect.left <= rangeRect.right && rect.top >= rangeRect.top && rect.top <= rangeRect.bottom) ||\n      // (rect.right >= rangeRect.left && rect.right <= rangeRect.right && rect.top >= rangeRect.top && rect.top <= rangeRect.bottom) ||\n      // (rect.left >= rangeRect.left && rect.left <= rangeRect.right && rect.bottom >= rangeRect.top && rect.bottom <= rangeRect.bottom) ||\n      // (rect.right >= rangeRect.left && rect.right <= rangeRect.right && rect.bottom >= rangeRect.top && rect.bottom <= rangeRect.bottom)\n      ) {\n          self.includeEls.push(itemEl);\n        } else {\n        self.excludeEls.push(itemEl);\n      }\n    }\n\n    if (self.config.moveInclude) {\n      self.config.moveInclude([].concat(self.includeEls));\n    }\n\n    if (self.config.moveExclude) {\n      self.config.moveExclude([].concat(self.excludeEls));\n    }\n  });\n  /**\r\n   * mouseup\r\n   */\n\n  self.el.addEventListener('mouseup', function () {\n    self.ismove = false;\n    self.isdown = false;\n    self.baseX = null;\n    self.baseY = null;\n\n    if (self.cloneEl) {\n      self.cloneEl.parentElement.removeChild(self.cloneEl);\n      self.cloneEl = null;\n    }\n\n    if (self.config.upInclude) {\n      self.config.upInclude([].concat(self.includeEls));\n    }\n  });\n  /**\r\n   * mouseleave\r\n   */\n\n  self.el.addEventListener('mouseleave', function () {// console.log('鼠标离开了el');\n  });\n  /**\r\n   * mouseup\r\n   */\n\n  document.body.addEventListener('mouseup', function () {\n    self.ismove = false;\n    self.isdown = false;\n    self.baseX = null;\n    self.baseY = null;\n\n    if (self.cloneEl) {\n      self.cloneEl.parentElement.removeChild(self.cloneEl);\n      self.cloneEl = null;\n    }\n\n    if (self.config.upInclude) {\n      self.config.upInclude([].concat(self.includeEls));\n    }\n  });\n}\n/**\r\n * Selectable\r\n * @class Selectable\r\n * @classdesc Selectable\r\n */\n\n\nvar Selectable =\n/**\r\n * constructor\r\n * @constructor\r\n * @param {HTMLElement} - el\r\n * @param {Object} - config\r\n */\nfunction Selectable(el, config) {\n  (0, _classCallCheck2[\"default\"])(this, Selectable);\n  this.el = el;\n  this.config = Object.assign({}, config);\n  this.isdown = false; // 是移动\n\n  this.ismove = false;\n  this.baseX = null;\n  this.baseY = null; // 选取节点\n\n  this.cloneEl = null;\n  this.includeEls = [];\n  this.excludeEls = [];\n  initEvents.call(this);\n};\n/**\r\n * SelectableFactory\r\n */\n\n\nvar SelectableFactory = {\n  /**\r\n   * 创建一个Selectable\r\n   * @param {HtmlElement} - el\r\n   * @param {Object} - config\r\n   * @return {Selectable} - Selectable\r\n   */\n  create: function create(el, config) {\n    return new Selectable(el, config);\n  }\n};\nvar _default = SelectableFactory;\nexports[\"default\"] = _default;"]}